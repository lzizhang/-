"use strict";function page(){new ScrollBtn,new Nav(0),new Footer}new page;var Header=new Header;function ShowShopping(t){this.a=t,this.container=$(".list"),this.totalPrice=$("#totalPrice"),this.payment=$(".payment"),this.init()}function Update(){this.list=$(".list"),this.clearBtn=$("#clear"),this.all=$("#all"),this.init()}$.extend(ShowShopping.prototype,{init:function(){this.getData()},getData:function(){var e=this;$.ajax({type:"get",url:"../json/list.json",dataType:"json",success:function(t){e.show(t)}})},show:function(t){var e="",a=0;if(localStorage.getItem("commodity")){for(var n=JSON.parse(localStorage.getItem("commodity")),r=0;r<n.length;r++)for(var i in t)if(n[r].category==i){var o=!0,l=!1,p=void 0;try{for(var s,c=t[i][Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var d=s.value;d.id==n[r].id&&(e+='<li>\n\t\t\t\t\t\t\t\t\t\t<ul data-id="'+d.id+'" data-class="'+n[r].category+'"">\n\t\t\t\t\t\t\t\t\t\t\t<li><input type="checkbox" class="radio"/></li>\n\t\t\t\t\t\t\t\t\t\t\t<li><a href="particulars.html?class='+n[r].category+"&id="+d.id+'"><img src="'+d.img[0]+'"/></a></li>\n\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t\t<p><a href="particulars.html?class='+n[r].category+"&id="+d.id+'">'+d.title+"</a></p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>尺码：<span>"+n[r].size+"</span></p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>颜色：<span>"+n[r].color+"</span></p>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t<li>¥ <span>"+d.price+'</span></li>\n\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t\t<a id="minus" href="##">-</a>\n\t\t\t\t\t\t\t\t\t\t\t\t<input type="text" value="'+n[r].num+'" id="num" />\n\t\t\t\t\t\t\t\t\t\t\t\t<a id="add" href="##">+</a>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>[7天无理由退换]</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>[退现金]</p>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t<li>¥ <span>'+d.price*n[r].num+'</span></li>\n\t\t\t\t\t\t\t\t\t\t\t<li><a id="dle" href="##">删除</a></li>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t</li>',a+=d.price*n[r].num)}}catch(t){l=!0,p=t}finally{try{!o&&c.return&&c.return()}finally{if(l)throw p}}}}else this.payment.replaceWith("<div class='payment' style='background:none'>您的进货单还没有商品哦...赶紧去进货吧。</div>");this.ele=$("<div></div>").append(e),this.container.html(e),this.totalPrice.text(a),Header.upNum(),this.a&&new Update}}),new ShowShopping(1),$.extend(Update.prototype,{init:function(){this.numAdd(),this.numMinus(),this.numDle(),this.num(),this.selectAll(),this.dleSelect()},dleSelect:function(){this.clearBtn.on("click",$.proxy(this.dleSelectEvent,this))},dleSelectEvent:function(){var i=JSON.parse(localStorage.getItem("commodity"));this.list.find(".radio").each(function(t,r){$(r).prop("checked")&&$(i).each(function(t,e){if($(r).parent().parent().attr("data-id")==e.id&&$(r).parent().parent().attr("data-class")==e.category&&$(r).parent().next().next().find("span").eq(0).text()==e.size&&$(r).parent().next().next().find("span").eq(1).text()==e.color){delete i[t];var a=[];for(var n in i)a.push(i[n]);0==(i=a).length?localStorage.clear():localStorage.setItem("commodity",JSON.stringify(a))}})}),new ShowShopping},selectAll:function(){this.all.on("click",$.proxy(this.selectAllEvent,this)),this.list.find(".radio").on("click",$.proxy(this.radioEvent,this))},radioEvent:function(){var a=!0;this.list.find(".radio").each(function(t,e){$(e).prop("checked")||(a=!1)}),a?this.all.prop("checked",!0):this.all.prop("checked",!1)},selectAllEvent:function(){this.all.prop("checked")?this.list.find("input").prop("checked",!0):this.list.find("input").prop("checked",!1)},num:function(){this.list.on("blur","#num",$.proxy(this.numEvent,this))},numEvent:function(){var t=JSON.parse(localStorage.getItem("commodity")),e=!0,a=!1,n=void 0;try{for(var r,i=t[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;$(event.target).parent().parent().attr("data-id")==o.id&&$(event.target).parent().parent().attr("data-class")==o.category&&$(event.target).parent().prev().prev().find("span").eq(0).text()==o.size&&$(event.target).parent().prev().prev().find("span").eq(1).text()==o.color&&(Number($(event.target).val())<1?($(event.target).val(1),alert("数量不能小于1"),o.num=1):o.num=Number($(event.target).val()),localStorage.setItem("commodity",JSON.stringify(t)),new ShowShopping)}}catch(t){a=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(a)throw n}}},numDle:function(){this.list.on("click","#dle",$.proxy(this.dleEvent,this))},dleEvent:function(){for(var t=JSON.parse(localStorage.getItem("commodity")),e=0;e<t.length;e++){var a=t[e];if($(event.target).parent().parent().attr("data-id")==a.id&&$(event.target).parent().parent().attr("data-class")==a.category&&$(event.target).parent().prev().prev().prev().prev().prev().find("span").eq(0).text()==a.size&&$(event.target).parent().prev().prev().prev().prev().prev().find("span").eq(1).text()==a.color){delete t[e];var n=[];for(var r in t)n.push(t[r]);localStorage.setItem("commodity",JSON.stringify(n)),new ShowShopping}}},numAdd:function(){this.list.on("click","#add",$.proxy(this.addEvent,this))},addEvent:function(t){var e=JSON.parse(localStorage.getItem("commodity"));$(t.target).prev().val(Number($(t.target).prev().val())+1);var a=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value;$(t.target).parent().parent().attr("data-id")==l.id&&$(t.target).parent().parent().attr("data-class")==l.category&&$(t.target).parent().prev().prev().find("span").eq(0).text()==l.size&&$(t.target).parent().prev().prev().find("span").eq(1).text()==l.color&&(l.num=Number(l.num)+1,localStorage.setItem("commodity",JSON.stringify(e)),new ShowShopping)}}catch(t){n=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw r}}},numMinus:function(){this.list.on("click","#minus",$.proxy(this.minusEvent,this))},minusEvent:function(t){var e=JSON.parse(localStorage.getItem("commodity"));if(1==Number($(t.target).next().val())){$(t.target).next().val(1);var a=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value;$(t.target).parent().parent().attr("data-id")==l.id&&$(t.target).parent().parent().attr("data-class")==l.category&&$(t.target).parent().prev().prev().find("span").eq(0).text()==l.size&&$(t.target).parent().prev().prev().find("span").eq(1).text()==l.color&&(l.num=1,localStorage.setItem("commodity",JSON.stringify(e)),new ShowShopping)}}catch(t){n=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw r}}}else{$(t.target).next().val(Number($(t.target).next().val())-1);var p=!0,s=!1,c=void 0;try{for(var d,v=e[Symbol.iterator]();!(p=(d=v.next()).done);p=!0)l=d.value,$(t.target).parent().parent().attr("data-id")==l.id&&$(t.target).parent().parent().attr("data-class")==l.category&&$(t.target).parent().prev().prev().find("span").eq(0).text()==l.size&&$(t.target).parent().prev().prev().find("span").eq(1).text()==l.color&&(l.num=Number(l.num)-1,localStorage.setItem("commodity",JSON.stringify(e)),new ShowShopping)}catch(t){s=!0,c=t}finally{try{!p&&v.return&&v.return()}finally{if(s)throw c}}}}});